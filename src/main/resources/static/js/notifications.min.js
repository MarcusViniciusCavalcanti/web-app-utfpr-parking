"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var MessageSuccess=function(){function e(t,n,s,a,i,r,o,c,l,u){_classCallCheck(this,e),this._name=name,this._type=t,this._lastAccess=n,this._lastHoursAccess=s,this._carModel=a,this._plate=i,this._tax=r,this._accessNumber=o,this._userName=l,this._authorizedAccess=u,this._id=c}return _createClass(e,[{key:"name",get:function(){return this._userName}},{key:"userId",get:function(){return this._id}},{key:"type",get:function(){return this._type}},{key:"lastAccess",get:function(){return this._lastAccess}},{key:"lastHoursAccess",get:function(){return this._lastHoursAccess}},{key:"carModel",get:function(){return this._carModel}},{key:"plate",get:function(){return this._plate}},{key:"tax",get:function(){return this._tax}},{key:"accessNumber",get:function(){return this._accessNumber}},{key:"isAuthorizedAccess",get:function(){return this._authorizedAccess}}]),e}(),View=function(){function e(){_classCallCheck(this,e),this._recognizeSection=$("#recognizers")}return _createClass(e,[{key:"template",value:function(e){throw new Error("Você precisa implementar o método template")}},{key:"update",value:function(e){this._recognizeSection.children("div").remove();var t=document.createElement("div");t.innerHTML='\n            <div class="col-sm-4 col-md-offset-2">\n              <div class="user-info-sidebar">\n                <a href="#" class="user-img">\n                  <img src="/user/avatar/'.concat(e.userId,'" alt="user-img" class="img-cirlce img-responsive img-thumbnail" />\n                </a>\n                \n                <a href="/users/').concat(e.userId,'">\n                  <span class="user-status is-online"></span>\n                </a>\n                \n                <span class="user-title"> ').concat(e.name,'</span>\n                \n                <hr />\n                \n                <ul class="list-unstyled user-info-list">\n                  <li>\n                    <i class="fa-automobile"></i> ').concat(e.carModel,"\n                  </li>\n                  ").concat(this.checkType(e.type),'\n                  <li>\n                    <i class="fa-camera-retro"></i> Placa reconhecida ').concat(e.plate,"\n                  </li>\n                </ul>\n                \n                <hr />\n                \n                <ul>\n                  <li><span>Acessos: </span>").concat(e.accessNumber,"</li>\n                </ul>\n              </div>\n            </div>\n                \n            ").concat(this.template(e),"\n        "),this._recognizeSection.append(t),animationSidebar(),animationNotification(),animationTax()}},{key:"checkType",value:function(e){return"Servidor"===e||"Operador"===e?'\n                  <li>\n                    <i class="fa-briefcase"></i> Servidor\n                  </li>\n            ':"Aluno"===e?'\n                  <li>\n                    <i class="fa-graduation-cap"></i> Aluno\n                  </li>\n            ':"Visitante"===e?'\n                  <li>\n                    <i class="fa-slideshare"></i> Palestrante\n                  </li>\n            ':'\n                  <li>\n                    <i class="fa-question"></i>Desconhecido\n                  </li>\n            '}}]),e}(),ViewAuthorize=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,View),_createClass(t,[{key:"template",value:function(e){return'\n            <div class="col-sm-4">\n              <div class="xe-widget xe-progress-counter xe-progress-counter-green" data-count=".num" data-from="0" data-to="'.concat(e.tax,'" data-duration="2">\n                <div class="xe-background" style="left: -25%">\n                  <i class="linecons-thumbs-up"></i>\n                </div>\n                \n                <div class="xe-upper">\n                  <div class="xe-icon">\n                    <i class="linecons-thumbs-up"></i>\n                  </div>\n                  <div class="xe-label">\n                    <h3 class="text-center">Acesso Autorizado</h3>\n                    <p class="bg-success text-center">Usuário reconhecido</p>\n                    <span>Taxa de acerto</span>\n                    <strong class="num">0</strong>\n                  </div>\n                </div>\n                \n                <div class="xe-progress">\n                  <span class="xe-progress-fill" data-fill-from="0" data-fill-to="').concat(e.tax,'" data-fill-unit="%" data-fill-property="width" data-fill-duration="2" data-fill-easing="true"></span>\n                </div>\n\n                <div class="xe-lower">\n                  <span>Último acesso</span>\n                    <strong>').concat(e.lastAccess," as ").concat(e.lastHoursAccess,"</strong>\n                </div>\n              </div>\n            </div>\n        ")}}]),t}(),ViewUnauthorize=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,View),_createClass(t,[{key:"template",value:function(e){return'\n            <div class="col-sm-4">\n              <div class="xe-widget xe-progress-counter xe-progress-counter-pink" data-count=".num" data-from="0" data-to="'.concat(e.tax,'" data-duration="2">\n                <div class="xe-background" style="left: -25%">\n                  <i class="linecons-lock"></i>\n                </div>\n                \n                <div class="xe-upper">\n                  <div class="xe-icon">\n                    <i class="linecons-lock"></i>\n                  </div>\n                  <div class="xe-label">\n                    <h3 class="text-center">Acesso Não Autorizado</h3>\n                    <p class="bg-danger text-center">Usuário reconhecido</p>\n                    <span>Taxa de acerto</span>\n                    <strong class="num">0</strong>\n                  </div>\n                </div>\n                \n                <div class="xe-progress">\n                  <span class="xe-progress-fill" data-fill-from="0" data-fill-to="').concat(e.tax,'" data-fill-unit="%" data-fill-property="width" data-fill-duration="2" data-fill-easing="true"></span>\n                </div>\n\n                <div class="xe-lower">\n                  <span>Último acesso</span>\n                    <strong>').concat(e.lastAccess," as ").concat(e.lastHoursAccess,"</strong>\n                </div>\n              </div>\n            </div>\n        ")}}]),t}(),RecognizeSuccess=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"render",value:function(){this._message.isAuthorizedAccess?this._authorize.update(this._message):this._unauthorize.update(this._message)}},{key:"message",set:function(e){this._message=e,this._authorize=new ViewAuthorize,this._unauthorize=new ViewUnauthorize}}]),e}(),RecognizerFail=function(){function e(){_classCallCheck(this,e),this._recognizeSection=$("#recognizers")}return _createClass(e,[{key:"render",value:function(){this._recognizeSection.children("div").remove();var e=document.createElement("div");e.innerHTML='\n        <div class="row">\n          <div class="panel panel-default">\n            <div class="panel-body">\n              <div class="col-sm-6 col-md-offset-3">\n                <div class="xe-widget xe-progress-counter xe-progress-counter-yellow" data-count=".num" data-from="0" data-to="'.concat(this._message.tax,'" data-duration="2">\n\n                  <div class="xe-background" style="left: -15%">\n                    <i class="linecons-eye"></i>\n                </div>\n\n                <div class="xe-upper">\n                  <div class="xe-icon">\n                    <i class="linecons-eye"></i>\n                  </div>\n                  <div class="xe-label">\n                    <h3 class="text-center">Acesso Não Autorizado</h3>\n                    <p class="bg-warning text-center">\n                      Usuário não encontrado na base de dados <br/>\n                      Verique o pedido de acesso\n                    </p>\n                    <span>Taxa de acerto</span>\n                    <strong class="num">0</strong>\n                  </div>\n                </div>\n\n                <div class="xe-progress">\n                  <span class="xe-progress-fill" data-fill-from="0" data-fill-to="').concat(this._message.tax,'" data-fill-unit="%" data-fill-property="width" data-fill-duration="2" data-fill-easing="true"></span>\n                </div>\n\n                <div class="xe-lower">\n                  <span>Isso pode indicar que o usuário não foi cadastrado</span>\n                  <strong>Verifique esta ocorrência</strong>\n                </div>\n\n              </div>\n            </div>\n          </div>\n        </div>\n        '),this._recognizeSection.append(e),animationTax(),animNotficationFail()}},{key:"message",set:function(e){this._message=e}}]),e}();function animationSidebar(){var e=document.querySelector(".user-info-sidebar");return TweenMax.from(e,1,_defineProperty({x:100,opacity:0,ease:Back.easeOut.config(1.7)},"x",-500))}function animationNotification(){var e=document.querySelector(".xe-widget");return TweenMax.from(e,1,_defineProperty({x:-100,opacity:0,ease:Back.easeOut.config(1.7)},"x",500))}function animNotficationFail(){var e,t=document.querySelector(".xe-widget");return TweenMax.from(t,1,(_defineProperty(e={scale:0,opacity:0,ease:Back.easeOut.config(1.7)},"scale",0),_defineProperty(e,"opacity",0),e))}function animationTax(){$("[data-fill-from][data-fill-to]").each(function(e,t){var n=$(t),s=scrollMonitor.create(t);s.fullyEnterViewport(function(){var e={current:null,from:attrDefault(n,"fill-from",0),to:attrDefault(n,"fill-to",100),property:attrDefault(n,"fill-property","width"),unit:attrDefault(n,"fill-unit","%")},t={current:e.to,onUpdate:function(){n.css(e.property,e.current+e.unit)},delay:attrDefault(n,"delay",0)},a=attrDefault(n,"fill-easing",!0),i=attrDefault(n,"fill-duration",2.5);a&&(t.ease=Sine.easeOut),e.current=e.from,TweenMax.to(e,i,t),s.destroy()})}),$("[data-from][data-to]").each(function(e,t){var n=$(t),s=scrollMonitor.create(t);s.fullyEnterViewport(function(){var e={useEasing:attrDefault(n,"easing",!0),useGrouping:attrDefault(n,"grouping",!0),separator:attrDefault(n,"separator",","),decimal:attrDefault(n,"decimal","."),prefix:attrDefault(n,"prefix",""),suffix:attrDefault(n,"suffix","")},t="this"==attrDefault(n,"count","this")?n:n.find(n.data("count")),a=attrDefault(n,"from",0),i=attrDefault(n,"to",100),r=attrDefault(n,"duration",2.5),o=attrDefault(n,"delay",0),c=new String(i).match(/\.([0-9]+)/)?new String(i).match(/\.([0-9]+)$/)[1].length:0,l=new countUp(t.get(0),a,i,c,r,e);setTimeout(function(){l.start()},1e3*o),s.destroy()})})}var stomp=null,recognizeSuccess=new RecognizeSuccess,recognizeFail=new RecognizerFail;function connect(){var e={"${_csrf.headerName}":"${_csrf.token}"},t=new SockJS("/recognize");(stomp=Stomp.over(t)).connect(e,function(e){stomp.subscribe("/app/recognize",function(e){console.log("INITIAL: "+e);var t=$.parseJSON(e.body);$.each(t,function(e,t){update(t)})}),stomp.subscribe("/topic/recognize",function(e){console.log("New Message: "+e),update($.parseJSON(e.body))})})}function update(e){if(e){var t=null;if(e.identified){var n=new MessageSuccess(e.driver.type,e.driver.lastAccess,e.driver.lastHoursAccess,e.driver.carModel,e.driver.plate,e.tax,e.driver.accessNumber,e.driver.userId,e.driver.userName,e.driver.authorizedAccess);recognizeSuccess.message=n,t=recognizeSuccess}else recognizeFail.message=e,t=recognizeFail;t.render()}}$(document).ready(function(){connect()});
